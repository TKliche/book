[[part_appendix]]
= Appendixes

[[appendix_activemq]]
[appendix]
== Apache ActiveMQ

[role="lead"]
In this appendix, we describe how to install and configure Apache ActiveMQ to
support STOMP and MQTT protocols.

=== Download and Installation

Apache ActiveMQ latest release at the time of writing this book is 5.9.0.It  can be downloaded for its
http://activemq.apache.org/activemq-590-release.html[download page] and the
http://activemq.apache.org/getting-started.html[getting started page] contains all the information to install it.

For our setup, ActiveMQ will be installed in the directory +~/mobilewebmsg/mybroker+.

Once you have download the archive for ActiveMQ, it can be installed and started by running the commands:

[source,sh]
----
$ tar zxvf apache-activemq-5.9.0-bin.tar.gz
$ cd apache-activemq-5.9.0
$ mkdir ~/mobilewebmsg/
$ ./bin/activemq create ~/mobilewebmsg/mybroker
...
$ cd ~/mobilewebmsg/mybroker
$ ./bin/mybroker start
...
$ tail data/activemq.log
...
2013-06-14 19:44:52,801 | INFO  | Apache ActiveMQ 5.8.0 (mybroker, ID:retsina.local-53410-1371231892651-0:1) started | org.apache.activemq.broker.BrokerService | main
...
----

To stop he broker, run the following command:

[source,sh]
----
$ ./bin/mybroker stop
...
Stopping broker: mybroker
.... FINISHED
----

[[app_activemq_admin_console]]
=== Administration Web Console

When the broker is started, it can be administrated and managed using its Web console running at http://localhost:8161/hawtio[http://localhost:8161/hawtio]. Out of the box, you can log into the admin console using the **`admin`** / **`admin`** credentials.

Once you are logged in, you can check the +mybroker+ resource in the ActiveMQ tree.

[[img_app_activemq_1]]
.The mybroker Resource in ActiveMQ Web Console
image::images/AppendixA/ActiveMQ_console.png["The mybroker resource in ActiveMQ Web console"]

One interesting attribute is +transportConnectors+. If you click on the attribute value, a pop up screen opens and display all the protocols supported by ActiveMQ out of the box.

[[img_app_activemq_2]]
.ActiveMQ Default Transport Connectors.
image::images/AppendixA/transport_connectors.png["ActiveMQ Default Transport Connectors"]

For this book, the important ones are:

* Stomp: +stomp://jeff.local:61613+
* Mqtt: +mqtt://jeff.local:1883+
* Ws: +ws://jeff.local:61614+

They mean that to connect to ActiveMQ using the STOMP protocol we must connect to the +jeff.local+ host - this is the name of my machine on my local network, your ActiveMQ installation will have another value - on the port +61613+.

Likewise, to connect to ActiveMQ using the MQTT protocol, we must use again the +jeff.local+ host but on the port +1883+ this time.

Finally, there is also the Web Socket connector that must be used to connect from a Web browser, _regardless_ of the messaging protocol that we use.
We will use to connect to the +61614+ port from the Web browser for our Web applications that are using either STOMP or MQTT.
